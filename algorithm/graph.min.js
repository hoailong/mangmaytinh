function drawGraph(e){e.edges=e.edges.map(t=>({source:e.nodes.indexOf(t.source),target:e.nodes.indexOf(t.target),value:t.value})),e.nodes=e.nodes.map(e=>({name:e}));d3.scale.category10();$(".graph").empty();var t=d3.select(".graph").append("svg").attr({width:800,height:600}),n=d3.layout.force().nodes(e.nodes).links(e.edges).size([800,600]).linkDistance([200]).charge([-500]).theta(.1).gravity(.05).start(),r=t.selectAll("line").data(e.edges).enter().append("line").attr("id",function(e,t){return e.source.name+e.target.name}).style("stroke","#000").style("pointer-events","none"),o=t.selectAll("circle").data(e.nodes).enter().append("circle").attr({r:20}).style("fill","rgb(31, 119, 180)").attr("id",function(e,t){return e.name}).style("stroke","#000").style("cursor","pointer").call(n.drag).on("dblclick",function(e){process(!1,e.name)}).on("mouseover",function(e){load_edge(e.name)}).on("mouseout",function(e){load_edge()}),a=t.selectAll(".nodelabel").data(e.nodes).enter().append("text").attr({x:function(e){return e.x-5},y:function(e){return e.y+5},class:"nodelabel",stroke:"#fff"}).style("cursor","pointer").style("font-size","20px").on("dblclick",function(e){process(!1,e.name)}).on("mouseover",function(e){load_edge(e.name)}).on("mouseout",function(e){load_edge()}).text(function(e){return e.name}),s=t.selectAll(".edgepath").data(e.edges).enter().append("path").attr({d:function(e){return"M "+e.source.x+" "+e.source.y+" L "+e.target.x+" "+e.target.y},class:"edgepath","fill-opacity":0,"stroke-opacity":0,fill:"blue",stroke:"red",id:function(e,t){return"edgepath"+t}}).style("pointer-events","none"),c=t.selectAll(".edgelabel").data(e.edges).enter().append("text").style("pointer-events","none").attr({class:"edgelabel",id:function(e,t){return"edgelabel"+t},dx:80,dy:-5,"font-size":20,"font-weight":"bold",fill:"#000"});c.append("textPath").attr("xlink:href",function(e,t){return"#edgepath"+t}).style("pointer-events","none").text(function(e,t){return e.value}),t.append("defs").append("marker").attr({id:"arrowhead",viewBox:"-0 -5 10 10",refX:25,refY:0,orient:"auto",markerWidth:10,markerHeight:10,xoverflow:"visible"}).append("svg:path").attr("d","M 0,-5 L 10 ,0 L 0,5").attr("fill","#ccc").attr("stroke","#ccc"),n.on("tick",function(){r.attr({x1:function(e){return e.source.x},y1:function(e){return e.source.y},x2:function(e){return e.target.x},y2:function(e){return e.target.y}}),o.attr({cx:function(e){return e.x},cy:function(e){return e.y}}),a.attr("x",function(e){return e.x-5}).attr("y",function(e){return e.y+5}),s.attr("d",function(e){return"M "+e.source.x+" "+e.source.y+" L "+e.target.x+" "+e.target.y}),c.attr("transform",function(e,t){return e.target.x<e.source.x?(bbox=this.getBBox(),rx=bbox.x+bbox.width/2,ry=bbox.y+bbox.height/2,"rotate(180 "+rx+" "+ry+")"):"rotate(0)"})})}
